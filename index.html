<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Travel Sync // Phygital Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Heebo:wght@300;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="scan-line"></div>
    <div id="flash"></div>
    
    <div id="sync-screen" class="hud-overlay">
        <div class="sync-box">
            <h1>בובות מקומיות</h1>
            <input type="text" id="user-name" placeholder="הכנס שם..." class="terminal-input">
            
            <div class="upload-area">
                <input type="file" id="doll-photo-input" accept="image/*" hidden>
                <button class="btn" onclick="document.getElementById('doll-photo-input').click()">צלם בובה (רקע ירוק מומלץ)</button>
                <p id="file-status">סטטוס: ממתין לסריקה...</p>
            </div>
            <button class="btn btn-pink" onclick="initializePortal()">להתחיל</button>
        </div>
    </div>
    
    <div id="main-interface" style="display: none;">
        <div class="hud-header">
            <h2 id="welcome-message">SYS_READY // </h2>
            <div class="control-panel">
                <select id="destination" onchange="startTravel(this.value)">
                    <option value="">-- בחר עיר --</option>
                </select>
            </div>
        </div>
        <div id="map-viewport">
            <div id="map-zoom-container">
                <svg viewBox="0 0 300 850" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                    <path class="israel-shape" d="M155,10 L175,20 L195,45 L200,80 L215,130 L230,190 L225,230 L210,260 L195,290 L195,330 L205,370 L210,420 L190,480 L175,540 L160,610 L145,700 L130,780 L125,840 L108,840 L95,760 L85,670 L82,590 L88,510 L94,440 L84,380 L70,320 L64,250 L68,200 L82,175 L95,135 L102,95 L112,60 L122,35 L135,20 L150,12 Z" />
                </svg>
                <div id="markers-layer"></div>
                <div id="doll-container">
                    <img id="map-doll-img" src="" style="display:none;">
                </div>
            </div>
        </div>
    </div>
    
    <div id="travel-report" class="modal">
        <div class="modal-container">
            <div class="selfie-view">
                <img id="city-bg" src="">
                
                <div class="doll-overlay">
                    <img id="selfie-doll-img" src="">
                </div>
            </div>
            <div class="fact-card">
                <h2 id="city-name">שם העיר</h2>
                <hr style="border:1px solid var(--neon-cyan); margin:15px 0;">
                <p id="city-fact"></p>
                <button class="btn btn-pink" onclick="closeTravel()">חזור למפה</button>
                <button class="btn" onclick="showConfirmDialog()">אשר בחירה</button>
            </div>
        </div>
    </div>
    
    <!-- NEW: Confirmation Dialog -->
    <div id="confirm-dialog" class="modal">
        <div class="confirm-box">
            <h2>האם אתה בטוח?</h2>
            <p style="margin: 30px 0; font-size: 1.1rem;">זאת העיר שלי?</p>
            <div class="confirm-buttons">
                <button class="btn btn-pink" onclick="confirmCitySelection()">כן, זאת העיר שלי</button>
                <button class="btn" onclick="closeConfirmDialog()">לא</button>
            </div>
        </div>
    </div>

    <script src="cities.js"></script>
    <script src="script.js"></script>
</body>
</html>
